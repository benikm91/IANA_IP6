<!DOCTYPE html>
<html>
   <head>
      <script type="text/javascript">
         var socket = null;
         var isopen = false;

         window.onload = function() {

            socket = new WebSocket("ws://192.168.1.130:9000");
            socket.binaryType = "arraybuffer";

            socket.onopen = function() {
               console.log("Connected!");
               isopen = true;
            };

            socket.onmessage = function(e) {
               if (typeof e.data === "string") {
                  console.log("Text message received: " + e.data);
               } else {
                  const arr = new Uint8Array(e.data);
                  let hex = '';
                  for (let i = 0; i < arr.length; i++) {
                     hex += ('00' + arr[i].toString(16)).substr(-2);
                  }
                  console.log("Binary message received: " + hex);
               }
            };

            socket.onclose = function(e) {
               console.log("Connection closed.");
               socket = null;
               isopen = false;
            }
         };

         function explore() {
            if (isopen) {
               socket.send("explore");
               console.log("explore command sent.");
            } else {
               console.log("Connection not opened.");
            }
         }

         function goto_target() {
             const x = document.querySelector('input[name="goto_x"]').value;
             const y = document.querySelector('input[name="goto_y"]').value;
             goto(x, y);
         }

         function goto(x, y) {
            if (isopen) {
               socket.send(`goto ${x} ${y}`);
               console.log(`goto command sent with ${x} and ${y}.`);
            } else {
               console.log("Connection not opened.")
            }
         }

      </script>
   </head>
   <body>
        <div class="row">
            <div class="col-md-6">
                <button onclick='explore();'>Explore Modus</button>
            </div>
            <div class="col-md-6">
                <label for="goto_x">X: </label> <input id="goto_x" type="number" name="goto_x" />
                <label for="goto_y">Y: </label> <input id="goto_y" type="number" name="goto_y" />
                <button onclick='goto_target();'>Send Binary Message</button>
            </div>
        </div>
   </body>
</html>
